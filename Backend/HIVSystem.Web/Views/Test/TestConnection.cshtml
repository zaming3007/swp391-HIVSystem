@{
    ViewData["Title"] = "Test Connection String";
}

<div class="container">
    <h2><i class="fas fa-plug"></i> Test Connection String</h2>
    
    @if (!string.IsNullOrEmpty(ViewBag.Error))
    {
        <div class="alert alert-danger">
            <h4>‚ùå L·ªói:</h4>
            <p>@ViewBag.Error</p>
        </div>
    }
    
    @if (!string.IsNullOrEmpty(ViewBag.Message))
    {
        <div class="alert alert-info">
            <p>@ViewBag.Message</p>
        </div>
    }

    <div class="row">
        <div class="col-md-12">
            <div class="card">
                <div class="card-header">
                    <h4>üîó Connection String hi·ªán t·∫°i</h4>
                </div>
                <div class="card-body">
                    <div class="mb-3">
                        <label class="form-label"><strong>Connection String:</strong></label>
                        <div class="form-control" style="background-color: #f8f9fa; min-height: 60px; word-break: break-all;">
                            <code>@ViewBag.ConnectionString</code>
                        </div>
                    </div>
                    
                    <div class="mb-3">
                        <label class="form-label"><strong>Tr·∫°ng th√°i k·∫øt n·ªëi:</strong></label>
                        <div>
                            @if (ViewBag.CanConnect == true)
                            {
                                <span class="badge bg-success fs-6">‚úÖ K·∫øt n·ªëi th√†nh c√¥ng</span>
                            }
                            else
                            {
                                <span class="badge bg-danger fs-6">‚ùå K·∫øt n·ªëi th·∫•t b·∫°i</span>
                            }
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="mt-4">
        <div class="card">
            <div class="card-header">
                <h4>üîß Ki·ªÉm tra v√† s·ª≠a l·ªói</h4>
            </div>
            <div class="card-body">
                <div class="alert alert-warning">
                    <h5>‚ö†Ô∏è Nh·ªØng l√Ω do th∆∞·ªùng g√¢y l·ªói k·∫øt n·ªëi:</h5>
                    <ul>
                        <li><strong>SQL Server ch∆∞a ch·∫°y:</strong> Ki·ªÉm tra SQL Server Service c√≥ ƒëang ch·∫°y kh√¥ng</li>
                        <li><strong>Database ch∆∞a t·ªìn t·∫°i:</strong> T·∫°o database c√≥ t√™n "HIVHealthcareSystem"</li>
                        <li><strong>SQL Authentication ch∆∞a enable:</strong> Ki·ªÉm tra SQL Server c√≥ cho ph√©p SQL Authentication kh√¥ng</li>
                        <li><strong>User 'sa' b·ªã disable:</strong> Ki·ªÉm tra account 'sa' c√≥ enable kh√¥ng</li>
                        <li><strong>Password sai:</strong> Ki·ªÉm tra password c·ªßa user 'sa'</li>
                        <li><strong>Port 1433 b·ªã block:</strong> Ki·ªÉm tra firewall c√≥ block port 1433 kh√¥ng</li>
                    </ul>
                </div>

                <div class="alert alert-info">
                    <h5>üí° C√°c Connection String th·ª≠ kh√°c (SQL Authentication):</h5>
                    <div class="mb-2">
                        <strong>SQL Server v·ªõi port 1433:</strong>
                        <code>Server=localhost,1433;Database=HIVHealthcareSystem;User Id=sa;Password=12345;TrustServerCertificate=True</code>
                    </div>
                    <div class="mb-2">
                        <strong>SQL Server v·ªõi d·∫•u ch·∫•m:</strong>
                        <code>Server=.,1433;Database=HIVHealthcareSystem;User Id=sa;Password=12345;TrustServerCertificate=True</code>
                    </div>
                    <div class="mb-2">
                        <strong>SQL Server Express:</strong>
                        <code>Server=localhost\\SQLEXPRESS,1433;Database=HIVHealthcareSystem;User Id=sa;Password=12345;TrustServerCertificate=True</code>
                    </div>
                    <div class="mb-2">
                        <strong>N·∫øu d√πng Windows Authentication:</strong>
                        <code>Server=localhost;Database=HIVHealthcareSystem;Trusted_Connection=True;TrustServerCertificate=True</code>
                    </div>
                </div>

                <div class="alert alert-danger">
                    <h5>üîí C·∫•u h√¨nh SQL Server Authentication:</h5>
                    <ol>
                        <li>M·ªü SQL Server Management Studio (SSMS)</li>
                        <li>Right-click server ‚Üí Properties ‚Üí Security</li>
                        <li>Ch·ªçn "SQL Server and Windows Authentication mode"</li>
                        <li>Restart SQL Server service</li>
                        <li>Enable account 'sa' v√† set password</li>
                    </ol>
                </div>
            </div>
        </div>
    </div>

    <div class="mt-4">
        <div class="card">
            <div class="card-header">
                <h4>üõ†Ô∏è C√°c b∆∞·ªõc ki·ªÉm tra cho SQL Authentication</h4>
            </div>
            <div class="card-body">
                <ol>
                    <li><strong>Ki·ªÉm tra SQL Server ƒëang ch·∫°y:</strong>
                        <ul>
                            <li>M·ªü "Services" (Windows + R ‚Üí services.msc)</li>
                            <li>T√¨m "SQL Server (MSSQLSERVER)" ho·∫∑c "SQL Server (SQLEXPRESS)"</li>
                            <li>ƒê·∫£m b·∫£o service ƒëang "Running"</li>
                        </ul>
                    </li>
                    <li><strong>Enable SQL Authentication:</strong>
                        <ul>
                            <li>M·ªü SSMS, k·∫øt n·ªëi v·ªõi Windows Authentication</li>
                            <li>Right-click server name ‚Üí Properties</li>
                            <li>Security tab ‚Üí ch·ªçn "SQL Server and Windows Authentication mode"</li>
                            <li>Restart SQL Server service</li>
                        </ul>
                    </li>
                    <li><strong>Enable user 'sa':</strong>
                        <ul>
                            <li>Trong SSMS: Security ‚Üí Logins ‚Üí sa</li>
                            <li>Right-click sa ‚Üí Properties</li>
                            <li>General tab: set password l√† "12345"</li>
                            <li>Status tab: Login = Enabled</li>
                        </ul>
                    </li>
                    <li><strong>T·∫°o database:</strong>
                        <ul>
                            <li>Right-click Databases ‚Üí New Database</li>
                            <li>T√™n database: "HIVHealthcareSystem"</li>
                            <li>Click OK ƒë·ªÉ t·∫°o</li>
                        </ul>
                    </li>
                </ol>
            </div>
        </div>
    </div>

    <div class="mt-4 text-center">
        <a href="/Test/Database" class="btn btn-primary">
            <i class="fas fa-database"></i> Quay l·∫°i Database Test
        </a>
        <a href="/Account/Login" class="btn btn-success">
            <i class="fas fa-sign-in-alt"></i> Test ƒêƒÉng nh·∫≠p
        </a>
    </div>
</div> 